aliases-deployment-triggers:
  - &when_deploy_stage
    when:
      event:
        - promote
      environment:
        - stage
  - &when_deploy_prod
    when:
      event:
        - promote
      environment:
        - prod

kind: pipeline
type: docker
name: trigger only promote


steps:
  - name: test if
    image: golang
    comamnds:
        - echo "test"
    - if [ "test" == "tst"]; then echo "false"; fi;
      #- var1="test"
      #- if [ "$var1" == test ]; then echo "true" fi
      #- echo $var1
      #- echo "test lines"
    #- export ENV_VAR="testing"

  
  #- name: check var scope
  #  image: golang
  #  commands:
  #    - import ENV_VAR
  #    - echo $ENV_VAR

  - name: special
    image: golang
    commands:
     # - apt-get install dos2unix
#      - if  ${TEST} == 'DB' then echo "deploying now the database" elif ${TEST} == "ADF" then echo "deploying now adf" else echo "deploying both" fi
      - if [ -z "$TEST" ]; then echo "variable is null"; fi
    when:
      event:
        - promote
      target:
        - tst
  

trigger:
  branch:
  - main
