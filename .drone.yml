aliases-deployment-triggers:
  - &when_deploy_stage
    when:
      event:
        - promote
      environment:
        - stage
  - &when_deploy_prod
    when:
      event:
        - promote
      environment:
        - prod

kind: pipeline
type: docker
name: trigger only promote


steps:
  - name: hi
    image: golang
    commands:
    - echo "hi there"
    - echo $TEST
    - echo ${TEST}

  - name: special
    image: golang
    commands:
#      - if  ${TEST} == 'DB' then echo "deploying now the database" elif ${TEST} == "ADF" then echo "deploying now adf" else echo "deploying both" fi
      - [ -z "$TEST" ] && echo "variable is null"
    when:
      event:
        - promote
      target:
        - tst
  

trigger:
  branch:
  - main
